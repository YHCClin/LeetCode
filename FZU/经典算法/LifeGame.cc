#include <iostream>
#include <vector>
#include <string>
#include <stdio.h>
#include <wchar.h>
#include <windows.h>
#define N 30
using namespace std;

/*
	康威生命游戏的c++简单实现
 */
vector<vector<char>> board(N,vector<char>(N,' '));

/*
	清屏函数：若使用system("cls")会出现闪屏，因为该函数太慢了	
	由于数据量不大这里采用移动光标实现屏幕部分涂改，也可采用双缓冲机制(自行google)
 */
void clearScreen(){    
    HANDLE hConsole = GetStdHandle(STD_OUTPUT_HANDLE);
    COORD coordScreen = { 0, 0 };
    SetConsoleCursorPosition( hConsole, coordScreen );
}


// 判断周围生命个数
int direct[8][2] = {{0,1},{0,-1},{1,0},{-1,0},{-1,1},{1,-1},{-1,-1},{1,1}};
int countLiveFunc(vector<vector<char>>& board,int x,int y) {
	int count = 0;
	int nx,ny;
	for(int k = 0;k < 8;k++)
	{
		nx = x + direct[k][0];
		ny = y + direct[k][1];
		if(nx>=0 && nx<N && ny>=0 && ny<N && board[nx][ny]=='X')
		{
			count++;
		}
	}
	return count;
}
// 刷新函数
void fresh(vector<vector<char>> &board){
	int n = board.size();
	vector<vector<char>> newBoard(board);
	for(int i = 0;i < n;i++)
	{
		for(int j = 0;j < n;j++)
		{
			if(board[i][j]=='X')
			{
				int countLive = countLiveFunc(board,i,j);
				if(countLive<2) newBoard[i][j]=' ';
				else if(countLive==2 || countLive==3) continue;
				else if(countLive>3) newBoard[i][j]=' ';
			}
			else
			{
				int countLive = countLiveFunc(board,i,j);
				if(countLive==3) newBoard[i][j]='X';
			}
		}
	}
	board = newBoard;
}

void printBoard(){
	while(true){
		cout << '\n';
		cout << "||============================================================||"<<endl;
		cout << "||                   ||   GAME OF LIFE  ||                    ||"<<endl; 
		cout << "||============================================================||"<<endl;
		for(auto i : board){
			cout << "||";
			for(auto j : i)
				printf("%c ",j);
			cout << "||";
			cout << endl;
		}
		cout << "||============================================================||"<<endl;
		cout << "||At each step in time, the following transitions occur:      ||"<<endl;
		cout << "||                                                            ||"<<endl;
		cout << "||1. Any live cell with fewer than two live neighbours dies,  ||"<<endl;
		cout << "||   as if by underpopulation.                                ||"<<endl;
		cout << "||2. Any live cell with two or three live neighbours lives on ||"<<endl;
		cout << "||   to the next generation.                                  ||"<<endl;
		cout << "||3. Any live cell with more than three live neighbours dies, ||"<<endl;
		cout << "||   as if by overpopulation.                                 ||"<<endl;
		cout << "||4. Any dead cell with exactly three live neighbours becomes ||"<<endl;
		cout << "||   a live cell, as if by reproduction.                      ||"<<endl;
		cout << "||============================================================||"<<endl;
		Sleep(200);
		clearScreen();
		fresh(board);
	}
}

int main()
{
	// 初始化：脉冲星
	board = {
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','X','X','X',' ',' ',' ','X','X','X',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ','X',' ',' ',' ',' ','X',' ','X',' ',' ',' ',' ','X',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ','X',' ',' ',' ',' ','X',' ','X',' ',' ',' ',' ','X',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ','X',' ',' ',' ',' ','X',' ','X',' ',' ',' ',' ','X',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','X','X','X',' ',' ',' ','X','X','X',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','X','X','X',' ',' ',' ','X','X','X',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ','X',' ',' ',' ',' ','X',' ','X',' ',' ',' ',' ','X',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ','X',' ',' ',' ',' ','X',' ','X',' ',' ',' ',' ','X',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ','X',' ',' ',' ',' ','X',' ','X',' ',' ',' ',' ','X',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','X','X','X',' ',' ',' ','X','X','X',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',},
		{' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',}
	};
	// 执行打印函数
	printBoard();
	return 0;
}
